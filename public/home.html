<!DOCTYPE html>
<html lang="en">
<head>
<title>Chat</title>
    <script type="text/javascript">
    window.onload = function () {
        var conn;
        var msg = document.getElementById("msg");
        var log = document.getElementById("log");

        function appendLog(item) {
            var doScroll = log.scrollTop > log.scrollHeight - log.clientHeight - 1;
            log.appendChild(item);
            if (doScroll) {
                log.scrollTop = log.scrollHeight - log.clientHeight;
            }
        }

        document.getElementById("form").onsubmit = function () {
            if (!conn) {
                return false;
            }
            if (!msg.value) {
                return false;
            }
            conn.send(msg.value);
            msg.value = "";
            return false;
        };

        if (window["WebSocket"]) {
            conn = new WebSocket("ws://" + document.location.host + "/ws");
            conn.onclose = function (evt) {
                var item = document.createElement("div");
                item.innerHTML = "<b>Connection closed.</b>";
                appendLog(item);
            };
            conn.onmessage = function (evt) {
                var messages = evt.data.split('\n');
                for (var i = 0; i < messages.length; i++) {
                    var item = document.createElement("div");
                    item.innerText = messages[i];
                    appendLog(item);
                }
            };
        } else {
            var item = document.createElement("div");
            item.innerHTML = "<b>Your browser does not support WebSockets.</b>";
            appendLog(item);
        }
    };
    </script>
    <link rel="stylesheet" href="./css/style.css">
</head>

<body>
<!--<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1">-->
<div class="container">
    <div class="menu">
        <nav>
            <ul>
                <li>
                    Channel 1
                </li>
                <li>
                    Channel 2
                </li>
            </ul>
        </nav>
    </div>

    <form class="chat"id="form">
        <div id="log" class="conversation"></div>
        <div class="send-box">
            <input class="message" id="msg" class="sms-send" name="text" placeholder="" autocomplete="off"/>
            <button class="send" type="submit">Send</button>
        </div>
    </form>
</div>
</body>
</html>

